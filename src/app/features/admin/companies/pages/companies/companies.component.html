<div class="companies-container">
  <div class="page-header">
    <div class="header-start">
      <button mat-icon-button routerLink="/admin/dashboard" aria-label="Volver al dashboard">
        <mat-icon>arrow_back</mat-icon>
      </button>
      <h1 class="mat-headline-5">Compañías de Corretaje</h1>
    </div>
    
    <div class="header-center">
      <mat-form-field appearance="outline" class="search-field">
        <mat-label>Buscar por nombre o RIF</mat-label>
        <input matInput [formControl]="searchControl">
        <mat-icon matSuffix>search</mat-icon>
      </mat-form-field>
    </div>

    <div class="header-end">
       <button mat-fab extended color="primary" (click)="openForm()">
          <mat-icon>add</mat-icon>
          Añadir Compañía
        </button>
    </div>
  </div>

  <div class="companies-grid">
    @for (company of filteredCompanies(); track company.id) {
      <mat-card class="company-card">
        <mat-card-header>
          <mat-icon mat-card-avatar [color]="company.activo ? 'primary' : 'warn'">
            {{ company.activo ? 'business' : 'no_transfer' }}
          </mat-icon>
          <mat-card-title>{{ company.nombre }}</mat-card-title>
          <mat-card-subtitle>RIF: {{ company.rif }}</mat-card-subtitle>
        </mat-card-header>
        <mat-card-content>
          <p><mat-icon>email</mat-icon> {{ company.correo }}</p>
          <p><mat-icon>phone</mat-icon> {{ company.telefono }}</p>
        </mat-card-content>
        <mat-card-actions align="end">
          <button mat-button (click)="openForm(company)">Actualizar</button>
          <button mat-button [color]="company.activo ? 'warn' : 'primary'" (click)="toggleStatus(company)">
            {{ company.activo ? 'Desactivar' : 'Activar' }}
          </button>
        </mat-card-actions>
      </mat-card>
    } @empty {
      <div class="empty-state">
        <mat-icon>search_off</mat-icon>
        <p>No se encontraron compañías con ese criterio.</p>
      </div>
    }
  </div>
</div>
